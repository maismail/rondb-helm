{
    "$schema": "https://json-schema.org/draft-07/schema#",
    "properties": {
        "imagePullPolicy": {
            "type": "string",
            "description": "The Kubernetes image pull policy",
            "default": "IfNotPresent"
        },
        "imagePullSecrets": {
            "type": "array",
            "default": [],
            "items": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "The name of the Secret"
                    }
                }
            }
        },
        "isMultiNodeCluster": {
            "type": "boolean",
            "description": "Whether the Kubernetes cluster has multiple nodes; this will affect affinities and add requirements to scheduling.",
            "default": true
        },
        "staticCpuManagerPolicy": {
            "type": "boolean",
            "description": "Whether the Kubernetes cluster has been configured with a static CPU manager policy. This is an optimization for RonDB data nodes. These have a scheduler which executes jobs within hundreds of microseconds (very quick). If the data nodes are pinned to CPUs, they can run CPU spnning to avoid context switching inbetween jobs.",
            "default": false
        },
        "terminationGracePeriodSeconds": {
            "type": "integer",
            "description": "TerminationGracePeriodSeconds for data nodes. For debugging. When removing the *entire* cluster, taking down data nodes will hang, since they try to contact the MGMd on shutdown. Hence, this is a way of shortening this wait.",
            "default": 60,
            "minimum": 10
        },
        "priorityClass": {
            "type": "string",
            "default": "rondb-high-priority"
        },
        "enableSecurityContext": {
            "type": "boolean",
            "default": true
        },
        "serviceAccountAnnotations": {
            "type": "object",
            "default": {}
        },
        "networkPolicy": {
            "type": "object",
            "properties": {
                "mgmds": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean",
                            "default": true,
                            "description": "Whether to limit ingress for MGMd pods"
                        },
                        "ingressSelectors": {
                            "type": "array",
                            "default": [],
                            "items": {
                                "type": "object",
                                "properties": {
                                    "namespaceSelector": {
                                        "$ref": "#/$defs/selector"
                                    },
                                    "podSelector": {
                                        "$ref": "#/$defs/selector"
                                    }
                                }
                            }
                        }
                    }
                },
                "ndbmtds": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean",
                            "default": true,
                            "description": "Whether to limit ingress for data node pods. If there is an empty API slot in the config.ini, any host can connect to them."
                        },
                        "ingressSelectors": {
                            "type": "array",
                            "default": [],
                            "items": {
                                "type": "object",
                                "properties": {
                                    "namespaceSelector": {
                                        "$ref": "#/$defs/selector"
                                    },
                                    "podSelector": {
                                        "$ref": "#/$defs/selector"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "meta": {
            "type": "object",
            "properties": {
                "mgmd": {
                    "type": "object",
                    "properties": {
                        "statefulSetName": {
                            "type": "string",
                            "default": "mgmds"
                        },
                        "headlessClusterIp": {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "default": "headless-mgmds"
                                },
                                "port": {
                                    "type": "integer",
                                    "default": 1186
                                },
                                "annotations": {
                                    "type": "object",
                                    "default": {}
                                }
                            },
                            "required": [
                                "name"
                            ]
                        }
                    },
                    "required": [
                        "statefulSetName",
                        "headlessClusterIp"
                    ]
                },
                "ndbmtd": {
                    "type": "object",
                    "properties": {
                        "statefulSet": {
                            "type": "object",
                            "properties": {
                                "podAnnotations": {
                                    "type": "object",
                                    "default": {}
                                }
                            }
                        }
                    }
                },
                "mysqld": {
                    "type": "object",
                    "properties": {
                        "statefulSet": {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "default": "mysqlds"
                                },
                                "endToEndTls": {
                                    "type": "object",
                                    "properties": {
                                        "enabled": {
                                            "description": "Whether to use end-to-end encryption for MySQLd Pods. This is recommended for high-security use cases. For MySQLds this is especially recommended since they use raw TCP connections and thereby by-pass TLS Ingress-rules. Otherwise, Ingress-TCP can also be configured directly via the Ingress controller (not in this Helmchart).",
                                            "enabled": "boolean",
                                            "default": false
                                        },
                                        "secretName": {
                                            "type": "string",
                                            "description": "Name of the TLS Secret",
                                            "default": "mysqld-end-to-end-tls"
                                        },
                                        "supplyOwnSecret": {
                                            "enabled": "boolean",
                                            "default": false,
                                            "description": "Whether the Helmchart user will create a TLS Secret outside of this Helmchart. Otherwise we rely on cert-manager to create one."
                                        },
                                        "filenames": {
                                            "$ref": "#/$defs/tlsFilenames"
                                        }
                                    },
                                    "required": [
                                        "enabled",
                                        "secretName",
                                        "supplyOwnSecret",
                                        "filenames"
                                    ]
                                }
                            },
                            "required": [
                                "name",
                                "endToEndTls"
                            ]
                        },
                        "headlessClusterIp": {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "default": "headless-mysqlds"
                                },
                                "port": {
                                    "type": "integer",
                                    "default": 3306
                                }
                            },
                            "required": [
                                "name",
                                "port"
                            ]
                        },
                        "clusterIp": {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "default": "mysqld"
                                },
                                "port": {
                                    "type": "integer",
                                    "default": 3306
                                },
                                "annotations": {
                                    "type": "object",
                                    "default": {}
                                }
                            },
                            "required": [
                                "name",
                                "port"
                            ]
                        },
                        "externalLoadBalancer": {
                            "type": "object",
                            "description": "Configuration for load balancer service to be used for external access",
                            "properties": {
                                "enabled": {
                                    "type": "boolean",
                                    "default": false
                                },
                                "managed": {
                                    "type": "boolean",
                                    "default": true,
                                    "description": "LoadBalancer is managed by provider"
                                },
                                "name": {
                                    "type": "string",
                                    "default": "mysqld-external"
                                },
                                "class": {
                                    "type": [
                                        "string",
                                        "null"
                                    ],
                                    "default": null
                                },
                                "annotations": {
                                    "type": "object",
                                    "description": "Cloud provider load balancer specific annotations.",
                                    "default": {}
                                },
                                "port": {
                                    "type": "integer",
                                    "description": "Port to expose the service on",
                                    "default": 3306
                                },
                                "nodeSelector": {
                                    "additionalProperties": true,
                                    "description": "selector for nodes the load balancer can use to route traffic",
                                    "required": [],
                                    "title": "nodeSelector",
                                    "type": "object",
                                    "default": {}
                                }
                            },
                            "required": [
                                "enabled",
                                "managed"
                            ]
                        },
                        "exporter": {
                            "type": "object",
                            "description": "Configuration for mysqld exporter",
                            "properties": {
                                "metricsPort": {
                                    "type": "integer",
                                    "default": 9104
                                }
                            }
                        },
                        "addSysNiceCapability": {
                            "type": "boolean",
                            "default": true
                        }
                    },
                    "required": [
                        "statefulSet",
                        "headlessClusterIp",
                        "clusterIp"
                    ]
                },
                "rdrs": {
                    "type": "object",
                    "properties": {
                        "clusterIp": {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "default": "rdrs"
                                },
                                "annotations": {
                                    "type": "object",
                                    "default": {
                                        "consul.hashicorp.com/service-name": "rdrs",
                                        "prometheus.io/path": "/metrics",
                                        "prometheus.io/port": "4406",
                                        "prometheus.io/scheme": "https",
                                        "prometheus.io/scrape": "true"
                                    }
                                }
                            },
                            "required": [
                                "name"
                            ]
                        },
                        "statefulSet": {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "default": "rdrs"
                                },
                                "endToEndTls": {
                                    "type": "object",
                                    "properties": {
                                        "enabled": {
                                            "description": "Whether to use end-to-end encryption for RDRS Pods. This is recommended for high-security use cases.",
                                            "enabled": "boolean",
                                            "default": false
                                        },
                                        "secretName": {
                                            "type": "string",
                                            "description": "Name of the TLS Secret",
                                            "default": "rdrs-end-to-end-tls"
                                        },
                                        "supplyOwnSecret": {
                                            "enabled": "boolean",
                                            "default": false,
                                            "description": "Whether the Helmchart user will create a TLS Secret outside of this Helmchart. Otherwise we rely on cert-manager to create one."
                                        },
                                        "filenames": {
                                            "$ref": "#/$defs/tlsFilenames"
                                        }
                                    },
                                    "required": [
                                        "enabled",
                                        "secretName",
                                        "supplyOwnSecret",
                                        "filenames"
                                    ]
                                }
                            },
                            "required": [
                                "name",
                                "endToEndTls"
                            ]
                        },
                        "headlessClusterIpName": {
                            "type": "string",
                            "default": "rdrs-cluster-ip"
                        },
                        "externalLoadBalancer": {
                            "type": "object",
                            "description": "Configuration for load balancer service to be used for external access",
                            "properties": {
                                "enabled": {
                                    "type": "boolean",
                                    "default": false
                                },
                                "managed": {
                                    "type": "boolean",
                                    "default": true,
                                    "description": "LoadBalancer is managed by provider"
                                },
                                "name": {
                                    "type": "string",
                                    "default": "rdrs-external"
                                },
                                "class": {
                                    "type": [
                                        "string",
                                        "null"
                                    ],
                                    "default": null
                                },
                                "annotations": {
                                    "type": "object",
                                    "description": "Cloud provider load balancer specific annotations.",
                                    "default": {}
                                },
                                "nodeSelector": {
                                    "additionalProperties": true,
                                    "description": "selector for nodes the load balancer can use to route traffic",
                                    "required": [],
                                    "title": "nodeSelector",
                                    "type": "object",
                                    "default": {}
                                }
                            },
                            "required": [
                                "enabled",
                                "managed"
                            ]
                        },
                        "ingress": {
                            "type": "object",
                            "description": "Configuration of Ingress for RDRS",
                            "properties": {
                                "enabled": {
                                    "type": "boolean",
                                    "default": false
                                },
                                "class": {
                                    "type": "string",
                                    "default": "nginx"
                                },
                                "useDefaultBackend": {
                                    "type": "boolean",
                                    "description": "Whether to use the RDRS as a default backend for the Ingress; this makes it reachable without specifying a subdomain; i.e. an IP can be used instead.",
                                    "default": true
                                },
                                "dnsNames": {
                                    "type": "array",
                                    "items": {
                                        "type": "string",
                                        "description": "DNS names used for Ingress rules. These will also be used in the TLS certificate."
                                    },
                                    "default": [],
                                    "examples": [
                                        "rondb.com"
                                    ]
                                },
                                "tls": {
                                    "type": "object",
                                    "properties": {
                                        "enabled": {
                                            "type": "boolean",
                                            "description": "WARN: Nginx-ingress will always use encryption even if this is disabled. By enabling this, we simply have more control over the TLS Secret. The TLS Secrets are placed onto the Ingress controller instance. Ingress TLS is currently only supported with cert-manager (RonDB-standalone)",
                                            "default": true
                                        },
                                        "ipAddresses": {
                                            "type": "array",
                                            "items": {
                                                "type": "string",
                                                "description": "This will work if the a default backend is activated for the Ingress. A value here can be the external IP of the Ingress Controller"
                                            },
                                            "default": [],
                                            "examples": [
                                                "127.0.0.1"
                                            ]
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "required": [
                        "clusterIp",
                        "statefulSet",
                        "headlessClusterIpName"
                    ]
                },
                "binlogServers": {
                    "type": "object",
                    "properties": {
                        "statefulSet": {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "default": "mysqld-binlog-servers"
                                },
                                "endToEndTls": {
                                    "type": "object",
                                    "properties": {
                                        "enabled": {
                                            "description": "Whether to use end-to-end encryption for MySQL binlog server Pods. This is recommended for high-security use cases. For MySQLds this is especially recommended since they use raw TCP connections and thereby by-pass TLS Ingress-rules. Otherwise, Ingress-TCP can also be configured directly via the Ingress controller (not in this Helmchart).",
                                            "enabled": "boolean",
                                            "default": false
                                        },
                                        "secretName": {
                                            "type": "string",
                                            "description": "Name of the TLS Secret",
                                            "default": "binlog-end-to-end-tls"
                                        },
                                        "supplyOwnSecret": {
                                            "enabled": "boolean",
                                            "default": false,
                                            "description": "Whether the Helmchart user will create a TLS Secret outside of this Helmchart. Otherwise we rely on cert-manager to create one."
                                        },
                                        "filenames": {
                                            "$ref": "#/$defs/tlsFilenames"
                                        }
                                    },
                                    "required": [
                                        "enabled",
                                        "secretName",
                                        "supplyOwnSecret",
                                        "filenames"
                                    ]
                                }
                            },
                            "required": [
                                "name",
                                "endToEndTls"
                            ]
                        },
                        "headlessClusterIp": {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "default": "headless-binlog-servers"
                                },
                                "port": {
                                    "type": "integer",
                                    "default": 3306
                                }
                            },
                            "required": [
                                "name",
                                "port"
                            ]
                        },
                        "externalLoadBalancers": {
                            "type": "object",
                            "description": "One LoadBalancer per binlog server; Creating an (alternative) Ingress per binlog server is difficult",
                            "properties": {
                                "enabled": {
                                    "type": "boolean",
                                    "default": true
                                },
                                "namePrefix": {
                                    "type": "string",
                                    "default": "binlog-server"
                                },
                                "class": {
                                    "type": [
                                        "string",
                                        "null"
                                    ],
                                    "default": null
                                },
                                "annotations": {
                                    "type": "object",
                                    "description": "Cloud provider load balancer specific annotations.",
                                    "default": {}
                                },
                                "port": {
                                    "type": "integer",
                                    "description": "Port to expose the service on",
                                    "default": 3306
                                }
                            }
                        }
                    },
                    "required": [
                        "statefulSet",
                        "headlessClusterIp"
                    ]
                },
                "replicaAppliers": {
                    "type": "object",
                    "properties": {
                        "statefulSet": {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "default": "mysqld-replica-appliers"
                                },
                                "endToEndTls": {
                                    "type": "object",
                                    "properties": {
                                        "enabled": {
                                            "description": "Whether to use end-to-end encryption for MySQL replica applier Pods. This is recommended for high-security use cases. For MySQLds this is especially recommended since they use raw TCP connections and thereby by-pass TLS Ingress-rules. Otherwise, Ingress-TCP can also be configured directly via the Ingress controller (not in this Helmchart).",
                                            "enabled": "boolean",
                                            "default": false
                                        },
                                        "secretName": {
                                            "type": "string",
                                            "description": "Name of the TLS Secret",
                                            "default": "replica-applier-end-to-end-tls"
                                        },
                                        "supplyOwnSecret": {
                                            "enabled": "boolean",
                                            "default": false,
                                            "description": "Whether the Helmchart user will create a TLS Secret outside of this Helmchart. Otherwise we rely on cert-manager to create one."
                                        },
                                        "filenames": {
                                            "$ref": "#/$defs/tlsFilenames"
                                        }
                                    },
                                    "required": [
                                        "enabled",
                                        "secretName",
                                        "supplyOwnSecret",
                                        "filenames"
                                    ]
                                }
                            },
                            "required": [
                                "name",
                                "endToEndTls"
                            ]
                        },
                        "headlessClusterIp": {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "default": "headless-replica-appliers"
                                },
                                "port": {
                                    "type": "integer",
                                    "default": 3306
                                }
                            },
                            "required": [
                                "name",
                                "port"
                            ]
                        }
                    },
                    "required": [
                        "statefulSet",
                        "headlessClusterIp"
                    ]
                }
            },
            "required": [
                "mgmd",
                "mysqld",
                "rdrs"
            ]
        },
        "images": {
            "type": "object",
            "description": "Information for Docker images used in the cluster",
            "properties": {
                "rondb": {
                    "type": "object",
                    "properties": {
                        "registry": {
                            "type": "string",
                            "default": "docker.io"
                        },
                        "repository": {
                            "type": "string",
                            "default": "hopsworks"
                        },
                        "name": {
                            "type": "string",
                            "default": "rondb"
                        },
                        "tag": {
                            "type": "string",
                            "description": "The version of RonDB to use; This should always be equivalent to .Chart.AppVersion",
                            "default": "24.10.15"
                        }
                    }
                },
                "upgrade2410revokegrants": {
                    "type": "object",
                    "properties": {
                        "registry": {
                            "type": "string",
                            "default": "docker.io"
                        },
                        "repository": {
                            "type": "string",
                            "default": "hopsworks"
                        },
                        "name": {
                            "type": "string",
                            "default": "rondb"
                        },
                        "tag": {
                            "type": "string",
                            "description": "The version of RonDB to use when revoking bogus user privilege to upgrade from 22.10 to 24.10",
                            "default": "22.10.13-0.7"
                        }
                    }
                },
                "toolbox": {
                    "type": "object",
                    "properties": {
                        "registry": {
                            "type": "string",
                            "default": "docker.io"
                        },
                        "repository": {
                            "type": "string",
                            "default": "hopsworks"
                        },
                        "name": {
                            "type": "string",
                            "default": "hwutils"
                        },
                        "tag": {
                            "type": "string",
                            "default": "0.8"
                        }
                    }
                },
                "dataValidation": {
                    "type": "object",
                    "properties": {
                        "registry": {
                            "type": "string",
                            "default": "docker.io"
                        },
                        "repository": {
                            "type": "string",
                            "default": ""
                        },
                        "name": {
                            "type": "string",
                            "default": "python"
                        },
                        "tag": {
                            "type": "string",
                            "default": "3.12-slim"
                        }
                    }
                },
                "mysqldExporter": {
                    "type": "object",
                    "properties": {
                        "registry": {
                            "type": "string",
                            "default": "docker.hops.works"
                        },
                        "repository": {
                            "type": "string",
                            "default": "hopsworks"
                        },
                        "name": {
                            "type": "string",
                            "default": "mysqld_exporter"
                        },
                        "tag": {
                            "type": "string",
                            "default": "0.11.3"
                        }
                    }
                }
            },
            "required": [
                "rondb",
                "toolbox",
                "dataValidation"
            ]
        },
        "mysql": {
            "type": "object",
            "description": "How to initialize MySQL",
            "properties": {
                "sqlInitContent": {
                    "type": "object",
                    "description": "SQL to run *only once* at cluster startup. Try to make these scripts idempotent, in case they are re-run by accident. Do so by e.g. using `IF NOT EXISTS` in the SQL commands.",
                    "default": {},
                    "examples": [
                        {
                            "createMyUser": "CREATE USER foo IF NOT EXISTS;"
                        }
                    ]
                },
                "supplyOwnSecret": {
                    "type": "boolean",
                    "default": false,
                    "description": "If set to false, the Helmchart will auto-generate MySQL passwords. When running Global Replication as a secondary cluster, this should be set to true. Otherwise, the replication of ALTER root password will fail the cluster."
                },
                "clusterUser": {
                    "type": "string",
                    "description": "The MySQL user for K8s probes, benchmarks and for the standard my.cnf file.",
                    "default": "helm"
                },
                "exporter": {
                    "type": "object",
                    "description": "MySQL exporter configuration",
                    "properties": {
                        "enabled": {
                            "type": "boolean",
                            "default": false
                        },
                        "username": {
                            "type": "string",
                            "default": "exporter"
                        },
                        "maxUserConnections": {
                            "type": "integer",
                            "default": 3
                        }
                    }
                },
                "credentialsSecretName": {
                    "type": "string",
                    "description": "Secret name for MySQL users' passwords",
                    "minLength": 1,
                    "default": "mysql-passwords"
                },
                "users": {
                    "type": "array",
                    "default": [],
                    "items": {
                        "type": "object",
                        "properties": {
                            "username": {
                                "type": "string",
                                "description": "The username of the MySQL database user.",
                                "minLength": 1
                            },
                            "host": {
                                "type": "string",
                                "description": "The host from which the MySQL user can connect.",
                                "minLength": 1,
                                "examples": [
                                    "%"
                                ]
                            },
                            "privileges": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "database": {
                                            "type": "string",
                                            "description": "The MySQL database to which the privileges apply.",
                                            "minLength": 1,
                                            "examples": [
                                                "*"
                                            ]
                                        },
                                        "table": {
                                            "type": "string",
                                            "description": "The MySQL table to which the privileges apply.",
                                            "minLength": 1,
                                            "examples": [
                                                "*"
                                            ]
                                        },
                                        "withGrantOption": {
                                            "type": "boolean",
                                            "description": "Whether the user has the GRANT OPTION privilege.",
                                            "default": false
                                        },
                                        "privileges": {
                                            "type": "array",
                                            "minItems": 1,
                                            "items": {
                                                "type": "string",
                                                "description": "Privileges for the specific MySQL database.table.",
                                                "minLength": 1,
                                                "examples": [
                                                    "ALL",
                                                    "SELECT"
                                                ]
                                            }
                                        }
                                    },
                                    "required": [
                                        "database",
                                        "table",
                                        "privileges"
                                    ],
                                    "additionalProperties": false
                                },
                                "description": "Privileges assigned to the MySQL user."
                            }
                        },
                        "required": [
                            "username",
                            "host",
                            "privileges"
                        ],
                        "additionalProperties": false
                    },
                    "description": "A list of MySQL users and their privileges."
                },
                "config": {
                    "type": "object",
                    "description": "MySQL configuration options",
                    "properties": {
                        "maxConnections": {
                            "type": "integer",
                            "description": "Maximum number of connections to the MySQL server.",
                            "default": 512
                        },
                        "maxConnectErrors": {
                            "type": "string",
                            "description": "Maximum number of connection errors before the MySQL server blocks the host.",
                            "default": "9223372036854775807"
                        },
                        "maxPreparedStmtCount": {
                            "type": "integer",
                            "description": "Maximum number of prepared statements.",
                            "default": 65530
                        }
                    }
                }
            },
            "required": [
                "sqlInitContent",
                "exporter",
                "credentialsSecretName",
                "users"
            ]
        },
        "clusterSize": {
            "type": "object",
            "description": "Horizontal cluster size",
            "properties": {
                "activeDataReplicas": {
                    "type": "integer",
                    "description": "How many replicas each node group has. When descreasing this value, try going down by 1 at a time. Too many nodes leaving at once can cause issues with leader elections.",
                    "minimum": 1,
                    "maximum": 3,
                    "default": 2
                },
                "numNodeGroups": {
                    "type": "integer",
                    "minimum": 1,
                    "default": 1
                },
                "minNumMySQLServers": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "A minimum amount of MySQL servers",
                    "default": 1
                },
                "maxNumMySQLServers": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "The maximum amount of MySQL servers we will auto-scale to. It is represented as number of slots in RonDB's config.ini. Changing this will only take effect if the ConfigMap for config.ini is updated and the MGMd is restarted.",
                    "default": 5
                },
                "minNumRdrs": {
                    "type": "integer",
                    "minimum": 0,
                    "default": 1
                },
                "maxNumRdrs": {
                    "type": "integer",
                    "minimum": 0,
                    "default": 2
                }
            },
            "required": [
                "activeDataReplicas",
                "numNodeGroups",
                "minNumMySQLServers",
                "maxNumMySQLServers",
                "minNumRdrs",
                "maxNumRdrs"
            ]
        },
        "resources": {
            "type": "object",
            "description": "Vertical cluster size",
            "properties": {
                "limits": {
                    "type": "object",
                    "description": "Kubernetes resource limits",
                    "properties": {
                        "cpus": {
                            "type": "object",
                            "description": "CPU resources per RonDB service type",
                            "properties": {
                                "mgmds": {
                                    "type": "number",
                                    "default": 0.2
                                },
                                "ndbmtds": {
                                    "type": "number",
                                    "default": 2
                                },
                                "mysqlds": {
                                    "type": "number",
                                    "default": 2
                                },
                                "rdrs": {
                                    "type": "number",
                                    "default": 2
                                },
                                "benchs": {
                                    "type": "number",
                                    "default": 2
                                },
                                "restore": {
                                    "type": "number",
                                    "default": 1
                                },
                                "mysqldExporters": {
                                    "type": "number",
                                    "default": 0.2
                                }
                            }
                        },
                        "memory": {
                            "type": "object",
                            "description": "Memory resources per RonDB service type",
                            "properties": {
                                "ndbmtdsMiB": {
                                    "type": "integer",
                                    "description": "It is recommended to keep this above 5GiB, otherwise some memory parts will be configured manually.",
                                    "default": 5000,
                                    "minimum": 2800
                                },
                                "mysqldMiB": {
                                    "type": "integer",
                                    "description": "This can usually be kept at the default independent of the load",
                                    "default": 1400
                                },
                                "rdrsMiB": {
                                    "type": "integer",
                                    "default": 500
                                },
                                "benchsMiB": {
                                    "type": "integer",
                                    "default": 500
                                },
                                "mysqldExportersMiB": {
                                    "type": "integer",
                                    "default": 100
                                }
                            }
                        }
                    }
                },
                "requests": {
                    "type": "object",
                    "description": "Kubernetes resource requests; Note that data nodes will only apply limits, not requests",
                    "properties": {
                        "cpus": {
                            "type": "object",
                            "description": "CPU resources per RonDB service type",
                            "properties": {
                                "mgmds": {
                                    "type": "number",
                                    "default": 0.2
                                },
                                "mysqlds": {
                                    "type": "number",
                                    "default": 1
                                },
                                "rdrs": {
                                    "type": "number",
                                    "default": 1
                                },
                                "benchs": {
                                    "type": "number",
                                    "default": 1
                                },
                                "mysqldExporters": {
                                    "type": "number",
                                    "default": 0.02
                                }
                            }
                        },
                        "memory": {
                            "type": "object",
                            "description": "Memory resources per RonDB service type",
                            "properties": {
                                "mysqldMiB": {
                                    "type": "integer",
                                    "description": "This can usually be kept at the default independent of the load",
                                    "default": 650
                                },
                                "rdrsMiB": {
                                    "type": "integer",
                                    "default": 100
                                },
                                "benchsMiB": {
                                    "type": "integer",
                                    "default": 100
                                },
                                "mysqldExportersMiB": {
                                    "type": "integer",
                                    "default": 50
                                }
                            }
                        },
                        "storage": {
                            "type": "object",
                            "description": "Volume specifications",
                            "properties": {
                                "classes": {
                                    "type": "object",
                                    "description": "Storage classes",
                                    "properties": {
                                        "default": {
                                            "type": [
                                                "string",
                                                "null"
                                            ],
                                            "default": null,
                                            "description": "Default storage class name for all volumes"
                                        },
                                        "diskColumns": {
                                            "type": [
                                                "string",
                                                "null"
                                            ],
                                            "default": null,
                                            "description": "Storage class name for the data node disk columns volume"
                                        },
                                        "binlogFiles": {
                                            "type": [
                                                "string",
                                                "null"
                                            ],
                                            "default": null,
                                            "description": "Storage class name for MySQLd binlog volumes in global replication"
                                        },
                                        "mgmd": {
                                            "type": [
                                                "string",
                                                "null"
                                            ],
                                            "default": null,
                                            "description": "Storage class name for Management server"
                                        }
                                    }
                                },
                                "diskColumnGiB": {
                                    "type": "integer",
                                    "description": "This depends on how much data the user is expecting to place on disk",
                                    "default": 2,
                                    "minimum": 1
                                },
                                "redoLogGiB": {
                                    "type": "integer",
                                    "description": "64GiB is recommended for optimal performance",
                                    "default": 4,
                                    "minimum": 2,
                                    "maximum": 64
                                },
                                "undoLogsGiB": {
                                    "type": "integer",
                                    "maximum": 128,
                                    "default": 4,
                                    "minimum": 1,
                                    "description": "64GiB is recommended for good performance"
                                },
                                "ndbmtdGiB": {
                                    "type": "integer",
                                    "description": "The size of the statefulSet persistent volume for the RonDB data nodes",
                                    "default": 30,
                                    "minimum": 0
                                },
                                "logGiB": {
                                    "type": "integer",
                                    "default": 2
                                },
                                "binlogGiB": {
                                    "type": "integer",
                                    "description": "Keep in mind that this size needs to survive the retention period of the binlog files",
                                    "minimum": 1,
                                    "default": 4
                                },
                                "relayLogGiB": {
                                    "type": "integer",
                                    "minimum": 1,
                                    "default": 2
                                }
                            }
                        }
                    }
                }
            }
        },
        "rondbConfig": {
            "type": "object",
            "description": "Configurations for RonDB's config.ini. Memory configurations are in binary SI units (i.e. 1G = 1GiB = 1024MiB).",
            "properties": {
                "MaxNoOfTables": {
                    "type": [
                        "integer",
                        "null"
                    ],
                    "default": null
                },
                "MaxNoOfAttributes": {
                    "type": [
                        "integer",
                        "null"
                    ],
                    "default": null
                },
                "MaxNoOfTriggers": {
                    "type": [
                        "integer",
                        "null"
                    ],
                    "default": null
                },
                "TransactionMemory": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "default": null
                },
                "SharedGlobalMemory": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "default": null
                },
                "ReplicationMemory": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "default": null
                },
                "SchemaMemory": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "default": null
                },
                "RedoBuffer": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "default": null
                },
                "ReservedConcurrentOperations": {
                    "type": [
                        "integer",
                        "null"
                    ],
                    "default": null
                },
                "MaxNoOfConcurrentOperations": {
                    "type": "integer",
                    "default": 65536,
                    "minimum": 32,
                    "maximum": 4294967039
                },
                "MaxDMLOperationsPerTransaction": {
                    "type": "integer",
                    "default": 32768,
                    "minimum": 32,
                    "maximum": 4294967039
                },
                "MySQLdSlotsPerNode": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 4,
                    "default": 4
                },
                "RdrsSlotsPerNode": {
                    "type": "integer",
                    "description": "The number of cluster connections we support via the RDRS",
                    "minimum": 1,
                    "maximum": 1,
                    "default": 1
                },
                "RdrsMetadataSlotsPerNode": {
                    "type": "integer",
                    "description": "We use additional cluster connections for metadata",
                    "minimum": 1,
                    "maximum": 1,
                    "default": 1
                },
                "EmptyApiSlots": {
                    "type": "integer",
                    "description": "We need at least 1 for the MySQLd setup job. Otherwise this is for services that are not handled here, e.g. HopsFS",
                    "minimum": 1,
                    "default": 8
                },
                "OsStaticOverhead": {
                    "description": "Memory overhead for the RonDB datanode containers. Only set this if the container has less than 5GiB of memory.",
                    "type": [
                        "string",
                        "null"
                    ],
                    "default": null,
                    "example": "1400M"
                },
                "OsCpuOverhead": {
                    "description": "Additional OS memory overhead for the RonDB datanode containers. This is multiplied by the number of CPUs. Also only set this if the container has less than 5GiB of memory.",
                    "type": [
                        "string",
                        "null"
                    ],
                    "default": null,
                    "example": "100M"
                },
                "InitialTablespaceSizeGiB": {
                    "type": "integer",
                    "description": "InitialTableSpace size in GiB. By default, it is set to -1, which enforces the initial tablespace to use the entire diskColumnGiB space. If set to 0, the same behaviour applies and the diskColumnGiB is used.",
                    "default": -1
                },
                "DiskPageBufferMemory": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "DiskPageBufferMemory are used by disk columns. This is the page cache that contains disk pages when they are in memory. By default it is not defined.",
                    "default": null
                },
                "ActivateRateLimits": {
                    "type": "integer",
                    "description": "Activate rate limits handling",
                    "minimum": 0,
                    "maximum": 1,
                    "default": 0
                },
                "TransactionInactiveTimeout": {
                    "type": "integer",
                    "description": "Milliseconds that application waits before executing another part of transaction",
                    "default": 15000
                },
                "TransactionDeadlockDetectionTimeout": {
                    "type": "integer",
                    "description": "Time transaction can spend executing within data node",
                    "default": 1500
                },
                "HeartbeatIntervalDbApi": {
                    "type": "integer",
                    "description": "Each data node sends heartbeat signals to each MySQL server (SQL node) to ensure that it remains in contact. If a MySQL server fails to send a heartbeat in time it is declared “dead,” in which case all ongoing transactions are completed and all resources released. The SQL node cannot reconnect until all activities initiated by the previous MySQL instance have been completed. The three-heartbeat criteria for this determination are the same as described for HeartbeatIntervalDbDb.",
                    "default": 5000
                },
                "HeartbeatIntervalDbDb": {
                    "type": "integer",
                    "description": "One of the primary methods of discovering failed nodes is by the use of heartbeats. This parameter states how often heartbeat signals are sent and how often to expect to receive them. Heartbeats cannot be disabled. After missing four heartbeat intervals in a row, the node is declared dead. Thus, the maximum time for discovering a failure through the heartbeat mechanism is five times the heartbeat interval.",
                    "default": 5000
                },
                "TotalMemoryConfig": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "The total memory configured by RonDB datanode. By default it is not defined and memory is calculated automatically.",
                    "default": null
                }
            },
            "required": [
                "MySQLdSlotsPerNode",
                "RdrsSlotsPerNode",
                "RdrsMetadataSlotsPerNode",
                "EmptyApiSlots"
            ],
            "additionalProperties": false
        },
        "rdrs": {
            "type": "object",
            "properties": {
                "hpa": {
                    "type": "object",
                    "description": "Horizontal Pod Autoscaler for RDRS",
                    "properties": {
                        "additionalMetrics": {
                            "type": "array",
                            "description": "Additional metrics to use for the HPA. This is useful for custom metrics that are not supported by default.",
                            "default": [],
                            "items": {
                                "type": "object"
                            }
                        }
                    }
                },
                "externalMetadataCluster": {
                    "type": "object",
                    "description": "RDRSs will always be in the cluster of the data, not the metadata",
                    "properties": {
                        "slotsPerNode": {
                            "type": "integer",
                            "default": 1,
                            "minimum": 1,
                            "maximum": 1
                        },
                        "mgmds": {
                            "type": "array",
                            "maxItems": 1,
                            "default": [],
                            "items": {
                                "type": "object",
                                "properties": {
                                    "ip": {
                                        "type": "string",
                                        "minLength": 1
                                    },
                                    "port": {
                                        "type": "integer",
                                        "default": 1186
                                    }
                                },
                                "required": [
                                    "ip"
                                ]
                            }
                        }
                    },
                    "required": [
                        "slotsPerNode",
                        "mgmds"
                    ]
                }
            },
            "required": [
                "externalMetadataCluster"
            ]
        },
        "tls": {
            "type": "object",
            "description": "General settings how to use encrypted TLS connections with RonDB APIs (MySQL & RDRS).",
            "properties": {
                "caSecretName": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "User-provided TLS Secret. This can be used by the cert-manager as a base to sign further certificates. If not supplied, cert-manager will use a self-signed CA certificate.",
                    "default": null
                }
            }
        },
        "benchmarking": {
            "type": "object",
            "description": "Whether, which and how to run a benchmarking job on the cluster",
            "properties": {
                "enabled": {
                    "type": "boolean",
                    "description": "Whether to run a benchmarking job on the cluster",
                    "default": false
                },
                "type": {
                    "description": "Which benchmarking job to run. 'Multi' refers to multiple MySQLd servers to run against",
                    "enum": [
                        "sysbench",
                        "dbt2_single",
                        "dbt2_multi",
                        "ycsb"
                    ],
                    "default": "sysbench"
                },
                "dbt2": {
                    "type": "object",
                    "description": "Configuration of DBT2 benchmarking job",
                    "properties": {
                        "numWarehouses": {
                            "type": "integer",
                            "minimum": 1,
                            "default": 4
                        },
                        "runSingle": {
                            "type": "string",
                            "description": "Table with columns: NUM_MYSQL_SERVERS, NUM_WAREHOUSES, NUM_TERMINALS",
                            "default": "# NUM_MYSQL_SERVERS  NUM_WAREHOUSES  NUM_TERMINALS\n1 1 1\n1 2 1\n1 4 1\n1 4 2"
                        },
                        "runMulti": {
                            "type": "string",
                            "description": "Table with columns: NUM_MYSQL_SERVERS, NUM_WAREHOUSES, NUM_TERMINALS",
                            "default": "# NUM_MYSQL_SERVERS  NUM_WAREHOUSES  NUM_TERMINALS\n2 1 1\n2 2 1\n2 2 2"
                        }
                    }
                },
                "sysbench": {
                    "type": "object",
                    "description": "Configuration of Sysbench benchmarking job",
                    "properties": {
                        "threadCountsToRun": {
                            "type": "string",
                            "description": "Semi-colon-separated list of thread counts to run",
                            "default": "1;2;4;8;12;16;24;32;64"
                        },
                        "rows": {
                            "type": "integer",
                            "default": 100000
                        },
                        "minimizeBandwidth": {
                            "type": "boolean",
                            "default": false,
                            "description": "Whether to use filters to minimize bandwidth usage. This can be useful in cloud environments where bandwidth is expensive."
                        }
                    }
                },
                "ycsb": {
                    "type": "object",
                    "description": "Configuration of YCSB benchmarking job",
                    "properties": {
                        "schemata": {
                            "type": "string",
                            "description": "MySQL table schema to use for YCSB. NOTE: The `ycsb` database is pre-created.",
                            "default": "CREATE TABLE IF NOT EXISTS ycsb.usertable (YCSB_KEY VARCHAR(255) PRIMARY KEY, FIELD0 varbinary(4096));"
                        }
                    }
                }
            },
            "required": [
                "enabled",
                "type"
            ]
        },
        "timeoutsMinutes": {
            "type": "object",
            "description": "Using minutes for easier template addition",
            "properties": {
                "singleSetupMySQLds": {
                    "type": "integer",
                    "description": "This includes the time to start a single MySQLd pod, restoring MySQL metadata and running user-defined MySQL init scripts.",
                    "default": 5
                },
                "restoreNativeBackup": {
                    "type": "integer",
                    "description": "This does not include *downloading* the native backups. IMPORTANT; Restoring native backups is NOT done in parallel yet; TODO: Make this dependent on amount of data",
                    "default": 120
                }
            },
            "required": [
                "singleSetupMySQLds",
                "restoreNativeBackup"
            ]
        },
        "restoreFromBackup": {
            "type": "object",
            "description": "Whether to restore a backup on the cluster",
            "properties": {
                "backupId": {
                    "description": "The native backup ID for the backup to restore",
                    "type": [
                        "string",
                        "null"
                    ],
                    "default": null
                },
                "pathPrefix": {
                    "description": "Prefix of RonDB backup in the configured bucket",
                    "type": "string",
                    "default": "rondb_backup"
                },
                "objectStorageProvider": {
                    "enum": [
                        "s3",
                        null
                    ],
                    "default": null
                },
                "s3": {
                    "$ref": "#/$defs/s3"
                },
                "excludeDatabases": {
                    "description": "Which databases to exclude from the native backup",
                    "type": "array",
                    "default": [],
                    "items": {
                        "type": "string"
                    }
                },
                "excludeTables": {
                    "description": "Which tables to exclude from the native backup. Use the format: database.table",
                    "type": "array",
                    "default": [],
                    "items": {
                        "type": "string"
                    }
                }
            },
            "required": []
        },
        "backups": {
            "type": "object",
            "description": "Whether, how and how often to run regular backups on the cluster",
            "properties": {
                "enabled": {
                    "type": ["boolean", "null"],
                    "default": null
                },
                "pathPrefix": {
                    "description": "Prefix of RonDB backup in the configured bucket",
                    "type": "string",
                    "default": "rondb_backup"
                },
                "schedule": {
                    "description": "Cron schedule for backups",
                    "type": ["string", "null"],
                    "default": null
                },
                "objectStorageProvider": {
                    "enum": [
                        "s3",
                        null
                    ],
                    "default": null
                },
                "s3": {
                    "$ref": "#/$defs/s3"
                }
            }
        },
        "globalReplication": {
            "type": "object",
            "properties": {
                "clusterNumber": {
                    "type": "number",
                    "default": 1,
                    "description": "Determines the offset for global server IDs"
                },
                "primary": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean",
                            "description": "Specifies if the primary replication is enabled. This will actually create the binary log servers. Can be activated after an initial start.",
                            "default": false
                        },
                        "numBinlogServers": {
                            "type": "number",
                            "default": 2,
                            "description": "The current number of binlog servers, given global Replication is enabled."
                        },
                        "maxNumBinlogServers": {
                            "type": "number",
                            "default": 2,
                            "description": "Don't change this value. Determines how many binlog servers we can scale out to. Used to determine the server IDs for global replication. Even if replication is disabled, potential binlog servers will be written into the config.ini."
                        },
                        "expireBinlogsDays": {
                            "type": "number",
                            "default": 1.5
                        },
                        "logReplicaUpdates": {
                            "type": "boolean",
                            "default": false
                        },
                        "binlogFilename": {
                            "type": "string",
                            "default": "binlog"
                        },
                        "ignoreDatabases": {
                            "type": "array",
                            "default": [],
                            "items": {
                                "type": "string"
                            }
                        },
                        "includeDatabases": {
                            "type": "array",
                            "default": [],
                            "items": {
                                "type": "string"
                            }
                        }
                    },
                    "required": [
                        "enabled",
                        "numBinlogServers",
                        "maxNumBinlogServers",
                        "expireBinlogsDays",
                        "logReplicaUpdates"
                    ],
                    "additionalProperties": false
                },
                "secondary": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean",
                            "default": false
                        },
                        "replicateFrom": {
                            "type": "object",
                            "description": "RonDB clusters to replicate from. RonDB supports merge-replicating from multiple clusters, but we only support replicating from one cluster",
                            "properties": {
                                "clusterNumber": {
                                    "type": "number",
                                    "default": 2,
                                    "description": "A helper to understand from which serverIds to replicate from"
                                },
                                "useTlsConnection": {
                                    "type": "boolean",
                                    "default": false,
                                    "description": "Enable this for an encrypted replication channel. Important if the binlog server requires TLS connections"
                                },
                                "binlogServerHosts": {
                                    "type": "array",
                                    "description": "Hostnames of the binlog server to replicate from. The binlog servers have headless ClusterIPs and one LoadBalancer *per* binlog server. If we replicate across different K8s clusters, we can reference the External IPs of the binlog servers' LoadBalancers here.",
                                    "items": {
                                        "type": "string"
                                    },
                                    "default": []
                                },
                                "ignoreDatabases": {
                                    "type": "array",
                                    "items": {
                                        "type": "string"
                                    },
                                    "default": []
                                },
                                "ignoreTables": {
                                    "type": "array",
                                    "items": {
                                        "type": "string"
                                    },
                                    "default": []
                                },
                                "includeDatabases": {
                                    "type": "array",
                                    "items": {
                                        "type": "string"
                                    },
                                    "default": []
                                },
                                "includeTables": {
                                    "type": "array",
                                    "items": {
                                        "type": "string"
                                    },
                                    "default": []
                                }
                            },
                            "required": [
                                "binlogServerHosts"
                            ],
                            "additionalProperties": false
                        }
                    },
                    "additionalProperties": false,
                    "required": [
                        "enabled",
                        "replicateFrom"
                    ]
                }
            },
            "required": [
                "clusterNumber",
                "primary"
            ]
        },
        "nodeSelector": {
            "type": "object",
            "description": "This ensures that Kubernetes schedules pods only onto nodes that match all the specified labels.",
            "properties": {
                "mysqld": {
                    "type": "object",
                    "default": {}
                },
                "ndbmtd": {
                    "type": "object",
                    "default": {}
                },
                "mgmd": {
                    "type": "object",
                    "default": {}
                },
                "rdrs": {
                    "type": "object",
                    "default": {}
                },
                "backup": {
                    "type": "object",
                    "default": {}
                }
            }
        },
        "tolerations": {
            "type": "object",
            "description": "These tolerations allow Kubernetes to schedule pods on nodes with matching taints, ensuring proper placement based on cluster policies.",
            "properties": {
                "mysqld": {
                    "type": "array",
                    "default": []
                },
                "ndbmtd": {
                    "type": "array",
                    "default": []
                },
                "mgmd": {
                    "type": "array",
                    "default": []
                },
                "rdrs": {
                    "type": "array",
                    "default": []
                },
                "backup": {
                    "type": "array",
                    "default": []
                }
            }
        }
    },
    "required": [
        "images",
        "clusterSize",
        "resources",
        "rondbConfig",
        "timeoutsMinutes",
        "globalReplication"
    ],
    "$defs": {
        "$comment": "NOTE: All fields in this SCHEMA file need defaults, since auto-generate the values.yaml file with this. Hence, only reference objects that have generic defaults.",
        "s3": {
            "type": "object",
            "properties": {
                "provider": {
                    "type": ["string", "null"],
                    "default": null
                },
                "endpoint": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "default": null
                },
                "bucketName": {
                    "type": ["string", "null"],
                    "default": null
                },
                "region": {
                    "type": ["string", "null"],
                    "default": null
                },
                "serverSideEncryption": {
                    "enum": [
                        "aws:kms",
                        "aws:kms:dsse",
                        "AES256",
                        null
                    ],
                    "default": null
                },
                "keyCredentialsSecret": {
                    "type": "object",
                    "properties": {
                        "name": {
                            "type": ["string", "null"],
                            "description": "Name of the Secret",
                            "minLength": 1,
                            "default": null
                        },
                        "key": {
                            "type": ["string", "null"],
                            "description": "Key in the Secret",
                            "minLength": 1,
                            "default": null
                        }
                    }
                },
                "secretCredentialsSecret": {
                    "type": "object",
                    "properties": {
                        "name": {
                            "type": ["string", "null"],
                            "description": "Name of the Secret",
                            "minLength": 1,
                            "default": null
                        },
                        "key": {
                            "type": ["string", "null"],
                            "description": "Key in the Secret",
                            "minLength": 1,
                            "default": null
                        }
                    }
                }
            }
        },
        "tlsFilenames": {
            "type": "object",
            "properties": {
                "cert": {
                    "type": "string",
                    "default": "tls.crt",
                    "description": "Name of the certificate file in the Secret. ONLY overwrite this if you're not using standard TLS Secrets."
                },
                "key": {
                    "type": "string",
                    "default": "tls.key",
                    "description": "Name of the key file in the Secret. ONLY overwrite this if you're not using standard TLS Secrets."
                },
                "ca": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "default": null,
                    "description": "Name of the CA file in the Secret. ONLY overwrite this if you're not using standard TLS Secrets."
                }
            },
            "required": [
                "cert",
                "key"
            ]
        },
        "selector": {
            "type": "object",
            "properties": {
                "matchLabels": {
                    "type": "object",
                    "default": {},
                    "examples": [{
                        "app": "rondb"
                    }]
                },
                "matchExpressions": {
                    "type": "array",
                    "default": [],
                    "items": {
                        "type": "object",
                        "properties": {
                            "key": {
                                "type": "string"
                            },
                            "operator": {
                                "type": "string"
                            },
                            "values": {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "title": "Values",
    "type": "object"
}
